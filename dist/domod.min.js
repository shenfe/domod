!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.domod=e()}(this,function(){"use strict";function t(t,e,n,r){t.addEventListener?t.addEventListener(e,n,!!r):("input"===e&&(e="propertychange"),t.attachEvent("on"+e,n))}function e(t,n,r){n=n||function(){return!0};var i={};return O(t,function(t,o){if(E(t)&&!n(t)){var a=e(t,n,r);O(a,function(t,e){i[o+"."+e]=t})}else!n(t)&&r||(i[o]=t)}),i}function n(t,e,n){Object.defineProperty?Object.defineProperty(t,e,n):"value"in n&&(t[e]=n.value)}function r(t,e){E(t)&&1===arguments.length&&(e=t),D(t)||(t=[]),e||(e={}),n(this,"__data",{value:t}),n(this,"length",{get:function(){return t.length},set:function(e){t.length=e}});var r=this,i=["set","push","pop","unshift","shift","splice","resize"];i.forEach(function(t){n(r,"on"+t,{value:[]})}),i.forEach(function(t){r.addEventListener(t,e["on"+t])}),O(t,function(t,e){r.assignElement(e)})}function i(t,e,n,i){N(t)?"value"in n&&(t[e]=n.value):z(t,r)?n.set&&t.on("set",function(t,r,i,o){i==e&&n.set(r)}):Object.defineProperty(t,e,n),!1!==i&&(i=i||u(e,t),!V[i]&&("get"in n||"set"in n)&&(V[i]={}),"get"in n&&(V[i].get=n.get),"set"in n&&(V[i].set=n.set))}function o(t,e){return e&&""!==e?t&&""!==t?t+"."+e:e:t}function a(t){return t.replace(/"([0-9a-zA-Z$_]+)"/gm,function(t,e){return e}).replace(/'([0-9a-zA-Z$_]+)'/gm,function(t,e){return e}).replace(/\[([0-9a-zA-Z$_]+)\]/gm,function(t,e){return"."+e}).split(".")}function u(t,e){if(void 0===e)return t;var n=s(e);return null==n?t||"":o(n,t)}function s(t){if(t===S||!E(t)&&!N(t))return null;if(!t.__kernel_root){var e="kr_"+g();i(t,"__kernel_root",{value:e}),S[e]=t}return t.__kernel_root}function c(t,e){return(E(t)||m(t))&&(t=[t]),D(t)?t.map(function(t){return E(t)?o(s(t.root),t.alias):m(t)?o(s(e),t):null}):[]}function f(t,e,n){"string"==typeof e&&(e=a(e).join("."));var f,l={};if(null!=(l=function(t,e){void 0===e&&(e=S);if(!E(e)&&!N(e)||!m(t))return null;var n=u(t,e),r=n.lastIndexOf("."),i=n.substring(0,r),o=n.substring(r+1),a=p(null,i,X,!0);null==a&&(a=p(null,i,{},!0));return{target:a,property:o}}(e,t))){f=l.target[l.property];var h;l.target.__proppath?h=o(l.target.__proppath,l.property):(i(l.target,"__proppath",{value:o(s(t),a(e).slice(0,-1).join("."))}),h=o(s(t),e));var _=h+"#"+function(t){return void 0===G[t]?0:G[t].length}(h);i(this,"__kid",{value:_},!1),H[this.__kid]=1,void 0===G[h]&&(G[h]=[],j(l.target,l.property)&&!z(l.target,r)&&delete l.target[l.property]),G[h].push(1);var d=c(n.dnstream,t),v=n.resultIn,g=c(n.upstream,t),y=n.resultFrom,D=!!n.lazy;B[h]||(B[h]={}),d.forEach(function(t){W[t]||(W[t]={}),W[t][h]||(W[t][h]={}),W[t][h][_]=1,B[h][t]||(B[h][t]={}),B[h][t][_]=1}),R[h]||(R[h]=[]),R[h].push(A(v)?v:null),W[h]||(W[h]={}),g.forEach(function(t){W[h][t]||(W[h][t]={}),W[h][t][_]=1,B[t]||(B[t]={}),B[t][h]||(B[t][h]={}),B[t][h][_]=1}),A(y)&&(U[h]={f:y,k:this.__kid,deps:g}),D&&(K[h]=!0),1===G[h].length&&i(l.target,l.property,{get:function(){if(U[h]&&0!==H[U[h].k]){var e=U[h].f.apply(t,U[h].deps.map(function(t){return p(null,t)}));f!==e&&V[h].set(e)}return f},set:function(e,n){(n||e!==f)&&(e!==f&&(!z(l.target,r)||E(f)&&E(e)?f=w(f,e):(l.target.set(l.property,e),f=l.target[l.property])),R[h]&&R[h].forEach(function(e,n){e&&0!==H[h+"#"+n]&&e.apply(t,[f])}),B[h]&&O(B[h],function(t,e){var n=!1;O(t,function(t,e){if(0!==H[e])return n=!0,!1}),n&&U[e]&&!K[e]&&p(null,e)}))},enumerable:!0},h),j(n,"value")&&p(null,h,n.value)}}function l(t){if(!E(t))return!1;var e=!0,n={__isRelation:2,dnstream:1,resultIn:1,upstream:1,resultFrom:1,lazy:!0,value:!0},r=0;return O(t,function(t,i){return 2===n[i]?(e=!0,r++,!1):n[i]?void(1===n[i]&&r++):(e=!1,!1)}),e&&r>0}function h(t,n){var r;if(1===arguments.length){if(!E(t))return null;r=e(t,l,!0)}else{if(!E(n))return null;r=e(n,l,!0)}return O(r,function(e,n){new f(t,n,e)}),t}function p(t,e,n,i){t=t||S;var o=arguments.length>=3&&n!==X,u=t,s=[];e&&(s=a(e));for(var c,f;s.length;){if(i&&null==u)c[f]={};else if($(u))return;f=s.shift(),o&&0===s.length?!z(u,r)||E(u[f])&&E(n)?u[f]=w(u[f],n):u.set(f,n):(c=u,u=u[f])}return o?u[f]:u}function _(t,e,n){q.refBeginsWithDollar&&(t=t.replace(/(\$[a-zA-Z$_][0-9a-zA-Z$_]*)\s*=[^=]/g,function(t,e){return t.replace(e,"this."+e.substr(1))})),D(e)?n||(n=e[e.length-1]):(e=[e],n||(n=e[0]));var r={};O(e,function(t){O(t,function(t,e){e in r||(A(t)?r[e]=t.bind(n):r[e]=t)})});var i=Object.keys(r);q.refBeginsWithDollar&&(i=i.map(function(t){return"$"+t}));var o=Object.values(r);return new Function(i.join(","),"return ("+t+")").apply(n,o)}function d(t,e,n,r,i){D(e)||(e=[e]);var o=N(n),a=function(){var a=(i||function(){return function(t,e){t=function(t){return t.replace(/{{([^{}]*)}}/g,function(t,e){return"' + ("+e+") + '"})}(t);var n=null;try{n=_(t,e)}catch(t){}return n}(t,e)})();if(o&&"className"===r){var u=[];E(a)?O(a,function(t,e){t&&u.push(e)}):D(a)&&O(a,function(t){m(t)?u.push(t):E(t)&&O(t,function(t,e){t&&u.push(e)})}),a=u.join(" ")}else if(o&&"style.cssText"===r){var s=[];E(a)&&O(a,function(t,e){s.push(e+":"+t)}),a=s.join(";")}if(o&&r.startsWith(q.attrsFlag)){if(null!=a){var c=r.substr(q.attrsFlag.length);n.setAttribute(c,a)}}else p(n,r,a)},u=function(t,e){var n=function(t){t=";"+t+";";var e,n=function(t){return t.replace(/\.([0-9]+)([^0-9a-zA-Z$_]?)/g,function(t,e,n){return"["+e+"]"+n})};return q.refBeginsWithDollar?(t=t.replace(/([^a-zA-Z0-9$_.])this\./gm,function(t,e){return e+"$"}),e=/\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*/g,(t.match(e)||[]).map(function(t){return t.substr(1)}).map(n)):(t=t.replace(/([^a-zA-Z0-9$_.])this\./gm,function(t,e){return e}),e=/([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*/g,(t.match(e)||[]).map(n))}(t),r={};O(n,function(t){var n=P(t,e);r[n]||(r[n]={}),r[n][t]=p(e[n],t)});var i=[];return O(r,function(t,n){i.push({target:e[n],refs:x(t)})}),i}(t,e).map(function(t){return{target:t.target,relations:function(){var e={};return t.refs.forEach(function(t){e[t]={resultIn:a}}),e}()}});return a(),u}function v(e,n,i){if(!N(e)||!E(n))return null;var o=(i=i?D(i)?i:[i]:[]).concat(n),a=e.nodeName.toLowerCase();if(e.nodeType!==Node.ELEMENT_NODE||e[Q.domBoundFlag]){if(e.nodeType===Node.TEXT_NODE){var u=e.nodeValue,s=function(t){var e=[];return t.replace(/{{([^{}]*)}}/g,function(t,n){return e.push(n),""}),e}(u).join(";");if(""===s)return null;var c=e,f="nodeValue";"textarea"===e.parentNode.nodeName.toLowerCase()&&(c=e.parentNode,f="value"),d(s,o,c,f,function(){return function(t,e){return t.replace(/{{([^{}]*)}}/g,function(t,n){var r=null;try{r=_(n,e)}catch(t){}return r})}(u,o)}).forEach(function(t){h(t.target,t.relations)})}}else{if(e[Q.domBoundFlag]=!0,e.hasAttribute(q.attrPrefix+"each")){var l=q.attrPrefix+"each",g=function(t,e){var n,i,o,a;q.refBeginsWithDollar?(a=J.each12.exec(t))?(n=a[1].substr(1),i=a[3].substr(1),o=a[5].substr(1)):(n=(a=J.each11.exec(t))[1].substr(1),o=a[3].substr(1)):(a=J.each22.exec(t))?(n=a[1],i=a[3],o=a[5]):(n=(a=J.each21.exec(t))[1],o=a[3]);var u=L(o,e),s=p(u,o);return s instanceof r||p(u,o,s=new r(s)),{target:s,targetRef:o,iterator:{val:n,key:i}}}(e.getAttribute(l),n);e.removeAttribute(l);var y=e.parentNode;y.innerHTML="";var m=g.target;function A(t,r){var o=e.cloneNode(!0),a={};return a[g.iterator.val]=t,g.iterator.key&&(a[g.iterator.key]=r),v(o,n,[a].concat(i)),m.on({set:function(t,e,n,i){n==r&&(console.log("set",n,e),a[g.iterator.val]=e)},unshift:function(t){r++,a[g.iterator.key]=r},shift:function(){r>0&&(r--,a[g.iterator.key]=r)},splice:function(t,e,n){if(e)r>=t+e&&(r-=e,a[g.iterator.key]=r);else{var i=Array.prototype.slice.call(arguments,2).length;r>=t&&(r+=i,a[g.iterator.key]=r)}}}),o}return O(m,function(t,e){y.appendChild(A(t,e))}),void m.on({resize:function(){"select"===y.nodeName.toLowerCase()&&y.dispatchEvent(new Event("change"))},push:function(t){y.appendChild(A(t,m.length-1))},unshift:function(t){y.insertBefore(A(t,0),y.childNodes[0])},pop:function(){y.removeChild(y.lastChild)},shift:function(){y.removeChild(y.firstChild)},splice:function(t,e,n){if(e)for(;e>0;e--)y.removeChild(y.childNodes[t]);else{var r=Array.prototype.slice.call(arguments,2);O(r,function(e,n){y.insertBefore(A(e,t+n),y.childNodes[t+n])})}}})}O(e,function(t){v(t,n,i)});var b=[];O(e.attributes,function(r,u){if(u.startsWith(q.attrPrefix)){b.push(u),u=u.substr(q.attrPrefix.length).toLowerCase();var s=Z(u);if(s)t(e,s,function(t){_(r,[{e:t}].concat(o))},!0);else{if(tt[a]&&"value"===u){var c=q.refBeginsWithDollar?r.substr(1):r,f=L(c,i,n);t(e,tt[a],function(t){console.log("input change"),p(f,c,this.value)},!1)}u=Y[u]?Y[u]:q.attrsFlag+u;d(r,o,e,u).forEach(function(t){h(t.target,t.relations)})}}}),O(b,function(t){e.removeAttribute(t)})}return e}Object.keys||(Object.keys=function(t){if(t!==Object(t))throw new TypeError("Object.keys called on a non-object");var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}),Object.values||(Object.values=function(t){if(t!==Object(t))throw new TypeError("Object.values called on a non-object");var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(t[n]);return e});var g=function(){return 1e4*(new Date).getTime()+Math.floor(1e4*Math.random())},y=function(t){return"number"==typeof t},m=function(t){return"string"==typeof t},A=function(t){return"function"==typeof t},E=function(t){return null!=t&&!(t instanceof Array)&&"[object Object]"===Object.prototype.toString.call(t)},D=function(t){return"[object Array]"===Object.prototype.toString.call(t)},b=function(t){return t instanceof Array},$=function(t){return null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"function"==typeof t},z=function(t,e){return"function"==typeof e&&t instanceof e},N=function(t){return"function"==typeof Node&&t instanceof Node},Z=function(t){return!(!m(t)||!t.startsWith("on"))&&t.substr(2)},O=function(t,e,n){var r,i;if(!D(t)&&A(t.forEach))t.forEach(e);else if(E(t)){for(var o in t)if(t.hasOwnProperty(o)&&!1===e(t[o],o))break}else if(b(t))if(n)for(r=t.length-1;r>=0&&!1!==e(t[r],r);r--);else for(r=0,i=t.length;r<i&&!1!==e(t[r],r);r++);else if(N(t)){var a=!1;switch(t.nodeType){case Node.ELEMENT_NODE:break;case Node.TEXT_NODE:case Node.COMMENT_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_TYPE_NODE:case Node.DOCUMENT_FRAGMENT_NODE:default:a=!0}if(a)return;var u=t.childNodes;for(r=0,i=u.length;r<i&&u[r];r++)e(u[r]),O(u[r],e)}else if(function(t){return t instanceof NamedNodeMap}(t))for(r=0,i=t.length;r<i&&!1!==e(t[r].nodeValue,t[r].nodeName);r++);},M=function(t){var e=t;return E(t)?(e={},O(t,function(t,n){e[n]=M(t)})):b(t)&&(e=new t.constructor,O(t,function(t){e.push(M(t))})),e},j=function(t,e){if(E(t))return t.hasOwnProperty(e);if(b(t)){var n=parseInt(e);return function(t){var e=parseInt(t);return!isNaN(e)&&("number"==typeof t||"string"==typeof t)&&e==t}(e)&&t.length>n&&n>=0}return!1},k=function(t,e,n){var r=m(e)||y(e),i=r?t[e]:t;(E(i)||b(i))&&(O(i,function(t,e){k(i,e)}),b(i)&&T(i)),r&&(t[e]=n)},T=function(t,e){if(y(e))for(O(t,function(n,r){if(!(r>=e))return!1;t.pop()},!0);t.length<e;)t.push(null);else O(t,function(e,n){null==e&&t.pop()},!0);return t},w=function(t,e,n,r){function i(t,e,n){return E(e)||b(e)?b(e)?b(t)?(t.splice.apply(t,[0,t.length].concat(e)),t):M(e):(O(e,function(e,r){!j(t,r)||$(e)?t[r]!==e&&(t[r]=M(e)):t[r]=i(t[r],e,n)}),n&&O(t,function(n,r){j(e,r)||k(t,r)}),t):e}if(!E(t))return e;var o,a=0;n=!1;var u=arguments[arguments.length-1];return A(u)?(a=2,u,n=!!arguments[arguments.length-2]):!0===u&&(a=1,n=u),o=Array.prototype.slice.call(arguments,1,arguments.length-a),O(o,function(e){t=i(t,e,n)}),t},x=function(t){if(b(t))return[];var e=[];return O(t,function(t,n){if(e.push(n),E(t)){var r=x(t);O(r,function(t){e.push(n+"."+t)})}}),e},C=function(t,e){for(var n=t,r=e.split(".");r.length;){var i=r.shift();if(!j(n,i))return!1;n=n[i]}return!0},L=function(t,e){for(var n,r=Array.prototype.slice.call(arguments,1),i=0,o=r.length;i<o;i++)if(n=r[i],D(n)){var a=L.apply(null,[t].concat(n));if(a)return a}else if(C(n,t))return n},P=function(t,e){var n=e.length-1;return O(e,function(e,r){if(C(e,t))return n=r,!1}),n},F=r.prototype=[];F.constructor=r,F.on=F.addEventListener=function(t,e){var n=this;E(t)?O(t,function(t,e){n.addEventListener(e,t)}):this["on"+t]&&A(e)&&this["on"+t].push(e)},F.off=F.removeEventListener=function(t,e){var n=this;if(E(t))O(t,function(t,e){n.removeEventListener(e,t)});else if(this["on"+t]&&A(e)){var r=this["on"+t];O(r,function(t,n){if(t===e)return r.splice(n,1),!1})}},F.trigger=F.dispatchEvent=function(t,e){e=Array.prototype.slice.call(arguments,1);var n=this;O(this["on"+t],function(t){t.apply(n,e)})},F.get=function(t){return this.__data[t]},F.set=function(t,e){var n=this.__data[t];$(n)||$(e)?(this.dispatchEvent("set",n,e,t,this.__data),this.__data[t]=e):w(n,e,!0)},F.assignElement=function(t){n(this,t,{get:function(){return this.get(t)},set:function(e){this.set(t,e)},configurable:!0,enumerable:!0})},F.deleteElement=function(){this.hasOwnProperty(this.length-1)&&delete this[this.length-1]},["push","unshift"].forEach(function(t){F[t]=function(e){this.__data[t](e),this.assignElement(this.length-1),this.dispatchEvent(t,e),this.dispatchEvent("resize")}}),["pop","shift"].forEach(function(t){F[t]=function(){this.dispatchEvent(t,this.__data["pop"===t?this.length-1:0]),this.deleteElement(),this.__data[t](),this.dispatchEvent("resize")}}),F.toArray=function(t){return t?this.__data:M(this.__data)},F.splice=function(t,e,n){(!y(t)||t<0)&&(t=0),t>=this.length&&(t=this.length),(!y(e)||e<0)&&(e=0),e+t>this.length&&(e=this.length-t);for(var r=[],i=t;i<t+e;i++)r.push(M(this.get(i)));for(var o=Array.prototype.slice.call(arguments,2),a=o.length,u=Math.min(e,a),s=t;s<t+u;s++)this.set(s,o[s-t]);if(e!==a){var c;e>a?(c=[t+a,e-a],Array.prototype.splice.apply(this.__data,c)):(c=[t+e,0].concat(o.slice(e)),Array.prototype.splice.apply(this.__data,c)),this.dispatchEvent.apply(this,["splice"].concat(c)),this.dispatchEvent("resize")}},F.forEach=function(t){for(var e=0;e<this.length;e++){if(!1===t(this.get(e),e))break}},["reverse","sort"].forEach(function(t){F[t]=function(){var e=M(this.__data);Array.prototype[t].apply(e,arguments);for(var n=0;n<this.length;n++)this.set(n,e[n])}}),["slice","concat","filter","map","reduce","indexOf","find","findIndex","fill","join"].forEach(function(t){F[t]=function(){return Array.prototype[t].apply(this.toArray(),arguments)}}),F.clear=function(){for(;this.length;)this.pop();return this},F.cast=function(t){return this.splice.apply(this,[0,this.length].concat(t))};if("object"!=typeof I)var I={};I._DMD_=I._DMD_||{};var S=I._DMD_.Store=I._DMD_.Store||{},B=I._DMD_.Dnstreams=I._DMD_.Dnstreams||{},R=I._DMD_.ResultsIn=I._DMD_.ResultsIn||{},W=I._DMD_.Upstreams=I._DMD_.Upstreams||{},U=I._DMD_.ResultsFrom=I._DMD_.ResultsFrom||{},K=I._DMD_.Laziness=I._DMD_.Laziness||{},G=I._DMD_.PropKernelTable=I._DMD_.PropKernelTable||{},H=I._DMD_.KernelStatus=I._DMD_.KernelStatus||{},V=I._DMD_.GetterSetter=I._DMD_.GetterSetter||{},X={};f.prototype.disable=function(){H[this.__kid]=0},f.prototype.enable=function(){H[this.__kid]=1},f.prototype.destroy=function(){};var q={attrPrefix:"m-",refBeginsWithDollar:!0,attrsFlag:"attrs."},Y={value:"value",checked:"checked",innertext:"innerText",innerhtml:"innerHTML",class:"className",style:"style.cssText"},J={each11:/^\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each12:/^\s*\(\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each21:/^\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each22:/^\s*\(\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/},Q={domBoundFlag:"__dmd_bound",domListKey:"__dmd_key"},tt={input:"input",select:"change"},et=function(t,e){if(m(t)&&(t=window.document.querySelector(t)),m(e)&&arguments.length>2){var n=e;e=arguments[2];var r=document.createDocumentFragment(),i=document.createElement("div");for(i.innerHTML=n;i.childNodes.length>0;)v.call(this,i.childNodes[0],e),r.appendChild(i.childNodes[0]);t.appendChild(r)}else v.call(this,t,e)};return et.kernel=f,et.relate=h,et.$=p,et});
//# sourceMappingURL=domod.min.js.map
